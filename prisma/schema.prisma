generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model MallaCurricular {
  id                        String              @id @default(uuid())
  modalidad                 Modalidad
  tituloObtenido            String
  tipoDuracion              TipoDuracion
  fechaAprobacion           DateTime
  fechaLimiteVigencia       DateTime
  niveles                   Int
  maximoMateriasMatricula   Int
  cantidadLibreOpcionEgreso Int
  cantidadOptativasEgreso   Int
  cantidadArrastres         Int
  practicasLigadasMaterias  Boolean
  horasPractica             Int
  registroPracticasDesde    Int
  horasVinculacion          Int
  registroVinculacionDesde  Int
  registroProyectosDesde    Int
  usaNivelacion             Boolean
  plantillasSilabo          Boolean
  observaciones             String?
  createdAt                 DateTime            @default(now())
  perfilEgreso              String?
  asignaturaEnMalla         AsignaturaEnMalla[]

  @@map("mallas_curriculares")
}

model Institucion {
  id        String          @id @default(uuid())
  nombre    String
  tipo      TipoInstitucion
  pais      String
  provincia String
  canton    String
  codigo    String
  createdAt DateTime        @default(now())

  @@map("instituciones")
}

model Asignatura {
  id                String              @id @default(uuid())
  nombre            String
  codigo            String?
  asignaturaEnMalla AsignaturaEnMalla[]

  @@map("asignaturas")
}

model AsignaturaEnMalla {
  ejeFormativo              String
  nivel                     Int
  areaConocimiento          String
  campoFormacion            String
  tipoAsignatura            String
  identificacion            String
  permiteMatriculacion      Boolean
  validaCredito             Boolean
  validaPromedio            Boolean
  costoEnMatricula          Boolean
  practicasPreProfesionales Boolean
  requeridaEgreso           Boolean
  cantidadMatriculas        Int
  horasSemanales            Int
  horasColaborativas        Int
  horasAsistidasDocente     Int
  horasAutonomas            Int
  horasPracticas            Int
  creditos                  Float
  noValidaAsistencia        Boolean
  materiaComun              Boolean
  objetivos                 String
  descripcion               String
  resultadosAprendizaje     String
  createdAt                 DateTime        @default(now())
  asignaturaId              String
  mallaId                   String
  asignatura                Asignatura      @relation(fields: [asignaturaId], references: [id])
  malla                     MallaCurricular @relation(fields: [mallaId], references: [id])

  @@id([asignaturaId, mallaId])
  @@index([mallaId], map: "asignaturas_en_mallas_mallaId_fkey")
  @@map("asignaturas_en_mallas")
}

enum Modalidad {
  VIRTUAL
  PRESENCIAL

  @@map("modalidad")
}

enum TipoDuracion {
  HORAS
  SEMANAS
  MESES
  ANOS

  @@map("tipo_duracion")
}

enum TipoInstitucion {
  FISCAL
  PARTICULAR

  @@map("tipo_institucion")
}
